(()=>{var n={508:(n,t,e)=>{var i=e(860),r=e(147),s=i.Router(),o=e(17).resolve(__dirname,"./db/users.json"),a=function(n,t,e){r.writeFile(o,JSON.stringify(t,null,2),(function(i){i?n.send(JSON.stringify(i)):n.send(JSON.stringify({auth:!0,firstName:t[e].firstName,login:t[e].login,cartContents:t[e].cartContents}))}))};s.post("/:login",(function(n,t){r.readFile(o,"utf-8",(function(e,i){if(e)t.send(JSON.stringify(e));else{var r=JSON.parse(i),s=r.findIndex((function(t){return t.login===n.params.login}));-1!==s?(r[s].cartContents.push(n.body),a(t,r,s)):t.sendStatus(404).end()}}))})),s.put("/:login",(function(n,t){r.readFile(o,"utf-8",(function(e,i){if(e)t.send(JSON.stringify(e));else{var r=JSON.parse(i),s=r.findIndex((function(t){return t.login===n.params.login})),o=r[s].cartContents.findIndex((function(t){return t.id===n.body.id}));-1!==s&&-1!==o?(r[s].cartContents[o].quantity=n.body.quantity,a(t,r,s)):t.sendStatus(404).end()}}))})),s.patch("/:login",(function(n,t){r.readFile(o,"utf-8",(function(e,i){if(e)t.send(JSON.stringify(e));else{var r=JSON.parse(i),s=r.findIndex((function(t){return t.login===n.params.login})),o=r[s].cartContents.findIndex((function(t){return t.id===n.body.id}));-1!==s&&-1!==o?(r[s].cartContents.splice(o,1),a(t,r,s)):t.sendStatus(404).end()}}))})),s.delete("/:login",(function(n,t){r.readFile(o,"utf-8",(function(e,i){if(e)t.send(JSON.stringify(e));else{var r=JSON.parse(i),s=r.findIndex((function(t){return t.login===n.params.login}));-1!==s?(r[s].cartContents=[],a(t,r,s)):t.sendStatus(404).end()}}))})),n.exports=s},440:(n,t,e)=>{var i=e(860),r=e(147),s=i.Router(),o=e(17).resolve(__dirname,"./db/users.json");s.search("/",(function(n,t){r.readFile(o,"utf-8",(function(e,i){if(e)t.send(JSON.stringify(e));else{var r=JSON.parse(i).find((function(t){return t.login===n.body.login}));r&&r.password===n.body.password?t.send(JSON.stringify({auth:!0,firstName:r.firstName,login:r.login,cartContents:r.cartContents})):t.sendStatus(404).end()}}))})),s.post("/",(function(n,t){r.readFile(o,"utf-8",(function(e,i){if(e)t.send(JSON.stringify(e));else{var s=JSON.parse(i);s.find((function(t){return t.login===n.body.login}))?t.sendStatus(404).end():(s.push(n.body),r.writeFile(o,JSON.stringify(s,null,2),(function(e){e?t.send(JSON.stringify(e)):t.send(JSON.stringify({auth:!0,firstName:n.body.firstName,login:n.body.login,cartContents:n.body.cartContents}))})))}}))})),n.exports=s},860:n=>{"use strict";n.exports=require("express")},147:n=>{"use strict";n.exports=require("fs")},17:n=>{"use strict";n.exports=require("path")}},t={};function e(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return n[i](s,s.exports,e),s.exports}(()=>{var n=e(860),t=e(147),i=e(508),r=e(440),s=n(),o=e(17);s.use(n.json()),s.use("/",n.static(o.resolve(__dirname,"../frontend"))),s.use("/cart",i),s.use("/user",r);var a=o.resolve(__dirname,"./db/products.json");s.get("/goods",(function(n,e){t.readFile(a,"utf-8",(function(n,t){n?e.send(JSON.stringify(n)):e.send(t)}))}));var d=process.env.PORT||5555;s.listen(d,(function(){console.log("Server started at port ".concat(d))}))})()})();